<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡å°‚ç”¨ãƒšãƒ¼ã‚¸ | æ™‹ãƒãƒ«ã‚µãƒ³ch</title>
  <!-- å…ƒã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ï¼ˆCSSã¯å…±æœ‰ã—ãŸã„ã®ã§å¤–éƒ¨åŒ–æ¨å¥¨ï¼‰ -->
  <style>
    /* å…ƒã®:rootã¨åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆã¾ãŸã¯<link>ã§å…±æœ‰CSSèª­ã¿è¾¼ã¿ï¼‰ */
    :root{
      --bgA:#fff4f6; --bgB:#fffdfe; --bgC:#f3fdff; --ink:#1f2937; --muted:#6b7280;
      --p:#ff4d6d; --p2:#ffb703; --p3:#4cc9f0; --shadow: 0 18px 50px rgba(0,0,0,0.12);
      --r: 18px; --max: 1100px;
    }
    body { margin:0; font-family: system-ui, sans-serif; background: linear-gradient(135deg, var(--bgA), var(--bgC)); min-height:100vh; color:var(--ink); }
    .container { width: min(var(--max), calc(100% - 28px)); margin-inline:auto; padding:40px 0; }
    .panel { background:#fff; border-radius:var(--r); box-shadow:var(--shadow); padding:30px; }
    h1 { text-align:center; font-size:clamp(24px,5vw,32px); margin-bottom:20px; }
    .status { text-align:center; font-size:18px; font-weight:900; padding:16px; border-radius:12px; margin-bottom:30px; }
    .premium { background:linear-gradient(135deg,var(--p),var(--p2)); color:#fff; }
    .not-premium { background:#fee2e2; color:#991b1b; }
    .btn-primary { display:block; width:100%; max-width:300px; margin:20px auto; padding:16px; background:linear-gradient(135deg,var(--p),var(--p2)); color:#fff; border:none; border-radius:999px; font-size:18px; font-weight:950; cursor:pointer; }
  </style>
</head>
<body>
  <div class="container">
    <div class="panel">
      <h1>ğŸ’ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡å°‚ç”¨ãƒšãƒ¼ã‚¸</h1>
      <div id="status" class="status">ç¢ºèªä¸­...</div>

      <!-- ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆæœ€åˆã¯éè¡¨ç¤ºï¼‰ -->
      <div id="premium-content" style="display:none;">
        <h2 style="text-align:center;">ğŸ‰ ã‚ˆã†ã“ãã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ã•ã‚“ï¼</h2>

        <!-- é«˜é€Ÿç‰ˆãƒœã‚¤ã‚¹ãƒ¡ãƒ¼ã‚«ãƒ¼ï¼ˆä¾‹ï¼‰ -->
        <section style="margin-top:40px;">
          <h3>ğŸš€ é«˜é€Ÿå®‰å€AIãƒœã‚¤ã‚¹ãƒ¡ãƒ¼ã‚«ãƒ¼ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ å°‚ç”¨ï¼‰</h3>
          <textarea id="premium-text" placeholder="ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ï¼ˆé«˜é€Ÿåˆæˆï¼‰" style="width:100%; min-height:150px; padding:16px; border-radius:12px; border:1px solid var(--border); font-size:16px;"></textarea>
          <button id="premium-generate" class="btn-primary" style="margin-top:12px;">é«˜é€Ÿåˆæˆç”Ÿæˆ</button>
          <audio id="premium-audio" controls style="width:100%; margin-top:16px;"></audio>
          <div id="premium-status" style="margin-top:12px; font-weight:900; color:var(--p);"></div>
        </section>

        <!-- é™å®šå‹•ç”»ãƒ»ç”»åƒä¾‹ -->
        <section style="margin-top:50px;">
          <h3>ğŸ“¹ é™å®šã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å‹•ç”»</h3>
          <div style="display:grid; gap:20px; grid-template-columns:repeat(auto-fit,minmax(300px,1fr));">
            <iframe src="https://www.youtube.com/embed/é™å®šå‹•ç”»ID1" allowfullscreen style="width:100%; aspect-ratio:16/9; border-radius:12px;"></iframe>
            <iframe src="https://www.youtube.com/embed/é™å®šå‹•ç”»ID2" allowfullscreen style="width:100%; aspect-ratio:16/9; border-radius:12px;"></iframe>
          </div>
        </section>

        <section style="margin-top:50px; text-align:center;">
          <h3>ğŸ–¼ é™å®šç”»åƒã‚®ãƒ£ãƒ©ãƒªãƒ¼</h3>
          <img src="images/premium-01.webp" alt="é™å®šç”»åƒ1" style="max-width:100%; border-radius:16px; box-shadow:var(--shadow);">
          <img src="images/premium-02.webp" alt="é™å®šç”»åƒ2" style="max-width:100%; border-radius:16px; box-shadow:var(--shadow); margin-top:20px;">
        </section>
      </div>

      <!-- éä¼šå“¡ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
      <div id="non-premium" style="display:none; text-align:center;">
        <p>ã“ã®ãƒšãƒ¼ã‚¸ã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡é™å®šã§ã™ã€‚</p>
        <a href="/" class="btn-primary">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
      </div>
    </div>
  </div>

  <!-- Supabaseã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    const supabaseUrl = "https://YOUR-PROJECT-ID.supabase.co";
    const supabaseAnonKey = "your-anon-public-key";
    const supabase = createClient(supabaseUrl, supabaseAnonKey);

    const statusEl = document.getElementById('status');
    const premiumContent = document.getElementById('premium-content');
    const nonPremium = document.getElementById('non-premium');

    async function checkPremium() {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) {
        statusEl.textContent = "âš ï¸ ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™";
        statusEl.className = "status not-premium";
        nonPremium.style.display = "block";
        return;
      }

      const { data } = await supabase
        .from('stripe.subscriptions')
        .select('status')
        .eq('status', 'active')
        .eq('client_reference_id', user.id);

      if (data && data.length > 0) {
        statusEl.textContent = "âœ… ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡èªè¨¼å®Œäº†ï¼";
        statusEl.className = "status premium";
        premiumContent.style.display = "block";
      } else {
        statusEl.textContent = "âŒ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ã§ã¯ã‚ã‚Šã¾ã›ã‚“";
        statusEl.className = "status not-premium";
        nonPremium.style.display = "block";
      }
    }

    // é«˜é€ŸTTSï¼ˆä¾‹: æ—¢å­˜APIã‚’ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å°‚ç”¨ã«å¤‰æ›´ or ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¿½åŠ ï¼‰
    document.getElementById('premium-generate')?.addEventListener('click', async () => {
      const text = document.getElementById('premium-text').value.trim();
      if (!text) return alert("ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");

      document.getElementById('premium-status').textContent = "é«˜é€Ÿåˆæˆä¸­...";
      // ã“ã“ã«ã‚ãªãŸã®é«˜é€ŸTTS APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å‘¼ã³å‡ºã—
      // ä¾‹: fetch('/api/tts-premium', { method:'POST', body:JSON.stringify({text}) })
      // å¿œç­”ã§éŸ³å£°URLã‚’å–å¾—ã—ã¦audio.srcã«ã‚»ãƒƒãƒˆ
    });

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«èªè¨¼ãƒã‚§ãƒƒã‚¯
    checkPremium();

    // èªè¨¼çŠ¶æ…‹å¤‰åŒ–æ™‚ã«ã‚‚ãƒã‚§ãƒƒã‚¯
    supabase.auth.onAuthStateChange(checkPremium);
  </script>
</body>
</html>